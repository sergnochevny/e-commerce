!function(a){function t(t,e,d){a.postdata(t,e,d,function(t){a.when(a("[data-edit_related]").html(t)).done(function(){var t=a("[data-carousel]").data("owl.carousel");if(t){var e=t.items();a.each(e,function(t,e){if(a(e).find("[data-pid]").length){var d=a(e).find("[data-pid]").attr("data-pid");a(".related_products input[data-pid="+d+"]").attr("checked",!0),a(".related_products input[data-pid="+d+"]").parents("label").addClass("checked")}})}})})}a(document).off(".search_action"),a(document).on("click","[data-related_add_ok]",function(t){t.preventDefault(),a("[data-edit_related]").empty(),a("[data-related_block]").hide(),a("[data-related-add]").show(),a("[data-fields_block]").show(),a("[data-submit_btn]").show()}),a(document).on("change","[data-related_chk]",function(t){var e=a("[data-carousel]").data("owl.carousel"),d=a(this).attr("data-pid");if(this.checked){a(this).parents("label").addClass("checked");var r=a(this).parents("label").find(".product-desc").text(),o=a(this).parents("label").find("figure").attr("style"),i="";if(i+='  <div class="product-item product-related" data-pid="'+d+'">',i+='    <div class="product-inner">',i+='      <figure class="product-image-box" style="'+o+'">',i+='        <input type="hidden" name="related[]" value="'+d+'"/>',i+="      </figure>",i+='      <div class="product-description">',i+='        <div class="product-name">'+r+"</div>",i+="      </div>",i+='      <a data-related_delete  href="jscript:void(0);" class="remove-related-product">Ã—</a>',i+="    </div>",i+="  </div>",!e){a("[data-carousel]").owlCarousel({responsive:{0:{items:1},520:{items:2},820:{items:3},990:{items:4}},margin:15,nav:!0,navText:['<i class="fa fa-chevron-left"></i>','<i class="fa fa-chevron-right"></i>'],autoplay:!0,loop:!1,rewind:!0,autoplayHoverPause:!0,autoplayTimeout:2e3,dots:!0});e=a("[data-carousel]").data("owl.carousel")}var c=e.add(i);a(this).attr("data-carousel_idx",c)}else{a(this).parents("label").removeClass("checked");var n=e.items();a.each(n,function(t,r){if(a(r).find("[data-pid="+d+"]").length)return e.remove(t),!1})}a("[data-related] .product-item").length?e.refresh():e.destroy()}),a(document).on("click","[data-related_delete]",function(t){t.preventDefault(),t.stopPropagation();var e=a("[data-carousel]").data("owl.carousel"),d=a(this).parents(".product-item").attr("data-pid");a(".related_products input[data-pid="+d+"]").removeAttr("checked"),a(".related_products input[data-pid="+d+"]").parents("label").removeClass("checked");var r=e.items();a.each(r,function(t,r){if(a(r).find("[data-pid="+d+"]").length)return e.remove(t),!1}),a("[data-related] .product-item").length?e.refresh():e.destroy()}),a(document).on("submit.search_action","[data-related_block] form[data-search]",function(e,d){if(e.stopPropagation(),e.preventDefault(),d){(r=new FormData).append("search[reset]",!0)}else var r=new FormData(this);var o=a("[data-related_block] form[data-sort]");o.length&&new FormData(o[0]).forEach(function(a,t){r.append(t,a)}),t(this,a(this).attr("action"),r)}),a(document).on("click.search_action","[data-related_block] form[data-search] [data-search_reset]",function(t){t.preventDefault(),t.stopPropagation(),a("[data-related_block] form[data-search]").trigger("submit",[!0])}),a(document).on("click.search_action","[data-related_block] form[data-search] [data-search_submit]",function(t){t.preventDefault(),t.stopPropagation(),a("[data-related_block] form[data-search]").trigger("submit")}),a(document).on("click.search_action","[data-related_block] [data-to_page]",function(e){e.preventDefault(),e.stopPropagation();var d=a("[data-related_block] form[data-search]");if(d.length)d.attr("action",a(this).attr("href")).trigger("submit");else{var r=new FormData,o=a("[data-related_block] form[data-sort]");o.length&&new FormData(o[0]).forEach(function(a,t){r.append(t,a)}),t(this,a(this).attr("href"),r)}}),a(document).on("click.search_action","[data-related_block] [data-sort]",function(e){e.preventDefault(),e.stopPropagation();var d=a("[data-related_block] form[data-search]");if(d.length)d.attr("action",a(this).attr("href")).trigger("submit");else{var r=new FormData,o=a("[data-related_block] form[data-sort]");o.length&&new FormData(o[0]).forEach(function(a,t){r.append(t,a)}),t(this,a(this).attr("href"),r)}}),a(document).on("click","[data-related-add]",function(t){t.preventDefault();var e=a("[data-edit_related]"),d=a("[data-related_get_list]").val();a(this).hide(),a(e).waitloader("show"),e.load(d,function(){a("[data-fields_block]").hide(),a("[data-submit_btn]").hide(),a("[data-related_block]").show();var t=a("[data-carousel]").data("owl.carousel");if(t){var e=t.items();a.each(e,function(t,e){if(a(e).find("[data-pid]").length){var d=a(e).find("[data-pid]").attr("data-pid");a(".related_products input[data-pid="+d+"]").attr("checked",!0),a(".related_products input[data-pid="+d+"]").parents("label").addClass("checked")}})}a("body").stop().animate({scrollTop:0})})}),a.change_button_text()}(jQuery);